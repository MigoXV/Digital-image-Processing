[TOC]

# 8.4 形态学的应用

## 8.4.1 形态学滤波

由于开、闭运算所处理的信息分别与图像的凸、凹处相关，因此，它们本身都是单边算子，可以利用开、闭运算去除图像的噪声、恢复图像，也可交替使用开、闭运算以达到双边滤波目的。一般，可以将开、闭运算结合起来构成形态学噪声滤波器，例如 $(X \circ S) \bullet S$ 或 $(X \bullet S) \circ S$ 等。 

图8-23给出消除噪声的一个图例。图8-23(a)包括一个长方形的目标 $X$, 由于噪声的影响在目标内部有一些噪声孔而在目标周围有一些噪声块。现在用图8-23(b)所示的结构元素S通过形态学操作来滤除噪声, 这里的结构元素应当比所有的噪声孔和块都要大。先用 $S$ 对 $X$ 进行腐蚀得到图8-23(c), 再用 $S$ 对腐蚀结果进行膨胀得到图8-23(d), 这两个操作的串行结合就是开运算, 它将目标周围的噪声块消除掉了。再用 $S$ 对图8-23(d)进行一次膨胀得到图8-23(e), 然后用 $S$ 对膨胀结果进行腐蚀得到图8-23(f), 这两个操作的串行结合就是闭运算, 它将目标内部的噪声孔消除掉了。整个过程是先做开运算再做闭运算, 可以写为

$$
\{[(X \ominus S) \oplus S] \oplus S\} \ominus S=(X \circ S) \bullet S
$$

![image-20230404150128958](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230404150128958.png)

图8-23 形态学滤波示意图

比较图8-23(a)和 (f), 可看出目标区域内外的噪声都消除掉了, 而目标本身除原来的4个直角变为圆角外没有太大的变化。 在利用开、闭运算滤除图像的噪声时, 选择圆形结构元素会得到较好的结果。为了能使从噪声污染的图像 $X$ 中恢复原始图像 $X_{0}$ 的结果达到最优, 在确定结构元素的半径时, 可以采用优化方法。为了达到这一目的, 可将图像和噪声视为随机过程, 通过统计优化分析得到优化结果。

相似的方法也可以应用于灰值图像处理。灰值开运算可用于过滤最大噪声(高亮度噪声), 因为被滤掉的噪声位于信号的上方。 如果将图8-20信号上方的尖峰视为噪声, 那么, 灰值开运算后可得到很好的滤波效果, 如图8-20(c)所示。根据对偶性, 闭运算可以滤掉信号下方的噪声尖峰。图8-20(d)给出了利用圆形结构元素进行灰值闭滤波的结果。与二值情况相似, 可以利用适当的结构元素进行开-闭滤波, 并且适当地选择结构元素的尺寸是非常关键的。此外, 如果信号中还混杂有不同尺寸的噪声脉冲, 并且噪声之间并没有很好地分离, 那么, 可以选用一种交变序列滤波器, 这种滤波器使用逐渐增加宽度的结构元素交替地做灰值开、闭运算。在一般情况下, 噪声往往由信号上下凸起的尖峰组成。只要这些噪声是很好分离的, 就可以利用开运算和闭运算的迭代运算或闭运算和开运算的迭代运算将其消除。 

## 8.4.2 骨架抽取

把一个平面区域简化成图(Graph)是一种重要的结构形状表示法。利用细化技术得到区域的细化结构是常用的方法。因此, 寻找二值图像的细化结构是图像处理的一个基本问题。在图像识别或数据压缩时, 经常要用到这样的细化结构, 例如,在识别字符之前, 往往要先对字符作细化处理, 求出字符的细化结构。骨架便是这样的一种细化结构, 它是目标的重要拓扑描述，具有非常广泛的应用。 

下面首先对数字图像细化概念做简要介绍。许多数学形态学算法都依赖于击中/击不中变换。其中数字图像细化, 便是一种最常见的使用击中/击不中变换的形态学算法。对于结构对 $B=\left(B_{1}\right.$, $\left.B_{2}\right)$ ， 利用 $B$ 细化 $X$ 定义为

$$
X \otimes B=X-(X \ominus B)
$$

即 $X \otimes B$ 为 $X$ 与 $X \ominus B$ 的差集。更一般地, 利用结构对序列 $B^{1} ， B^{2}$ ，.., $B^{N}$ 迭代地产生输出序列

$$
X^{1}=X \otimes B^{1}, X^{2}=X^{1} \otimes B^{2}, \Lambda, X^{N}=X^{N-1} \otimes B^{N}
$$

或者

$$
\left\{X^{i}\right\}=X \otimes\left\{B^{i}\right\}=\left(\Lambda\left(\left(X \otimes B^{1}\right) \otimes B^{2}\right) \Lambda B^{N}\right) \quad i=1,2, \ldots, N
$$

随着迭代的进行, 得到的集合也不断细化。假设输入集合是有限的 (即 $N$ 为有限), 最终将得到一个细化的图像。结构对的选择仅受结构元素不相交的限制。事实上, 每一个 $B^{i}(i=1,2, \ldots$, $N$ )都可以是相同的结构对, 即在不断重复的迭代细化过程使用同一个结构对。在实际应用中, 通常选择一组结构元素对, 迭代过程不断在这些结构对中循环，当一个完整的循环结束时, 如果所得结果不再变化, 则终止迭代过程。 

骨架还可以用中轴表示。设想在 $t=0$ 时刻, 将目标边界各处同时点燃, 火的前沿以匀速向目标内部萝延, 当前沿相交时火焰熄灭, 火焰熄灭点的集合就构成了中轴。图8-24(a) 是这个过程的图示。另外一种定义骨架的方法使用了最大圆盘概念：目标X的骨架由 $X$ 内所有最大内切圆盘的圆心组成, 如图8-24(b)、(c) 所示。最大圆盘不是其他任何完全属于 $X$ 的圆盘的子集, 并且至少有两点与目标边界轮廓相切。骨架的每个点都对应一个相应的最大圆盘和半径 $r$ 。最大圆盘定义的骨架与火种方式定义的骨架除在某些特殊情况下端点处存在差异外, 绝大多数情况下都是一致的。 

![image-20230404150234408](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230404150234408.png)

图8-24 骨架的定义 

按照最大圆盘定义骨架的方式, 在欧氏二值图像的内部任意给定一点, 如果以该点为圆心存在一个最大圆盘, 其整个盘体都在图像的内部, 且至少有两点与目标边界相切, 则该点便是骨架上的点。所有最大圆盘的圆心构成了图像的骨架(中轴)。 对于图像 $X$, 一般用 $S(X)$ 表示其骨架。注意, 不同的图像可能有相同的骨架。骨架对噪声非常敏感, 而且连通的集合可能具有不连通的骨架(例如两个相切圆盘的骨架)。 

数字骨架可以从形态学的角度进行定义。对于 $k=0,1$, $2 ， \ldots$, 定义骨架子集 $S_{k}(X)$ 为图像 $X$ 内所有最大圆盘 $k B$ 的圆心 $x$ 构成的集合。从骨架的定义可知, 骨架是所有骨架子集的并, 即

$$
S(X)=\cup\left\{S_{k}(X) \mid k=0,1,2, \ldots\right\}
$$

可以证明骨架子集为

$$
S_{k}(X)=(X \ominus k B)-[(X \ominus k B) \circ B]
$$

式中, $B$ 为结构元素, $(X \ominus k B)$ 代表连续 $k$ 次用 $B$ 对 $X$ 腐蚀, 即 

$$
(X \ominus k B)=((\ldots(X \ominus B) \ominus B) \ldots) \ominus B
$$

由此式和式 (8-33) 可得

$$
S(X)=\cup\{(X \ominus k B)-[(X \ominus k B) \circ B] \mid k=0,1,2, \ldots\} 
$$

这就是骨架的形态学表示, 它也是用数学形态学方法提取图像骨架技术的依据。对于给定的图像X以及结构元素 $B$, $(X \ominus k B)$ 可以将 $X$ 腐蚀为空集, 如果用 $N$ 表示 $(X \ominus k B)$ 运算将 $X$ 腐蚀成空集前的最后一次迭代次数, 即 

$$
N=\max \{k \mid(X \ominus k B) \neq \phi\}
$$

则式 (8-34)可以写为

$$
S(X)=\overset{N}{\underset{k=0}{Y}}\{(X\ominus kB)-[(X\ominus kB )\circ B]\}
$$

相反，图像$X$也可以用 $S_{k}(X)$ 重构, 即

$$
X=\overset{N}{\underset{k=0}Y}
\left\{S_{k}(X) \oplus k B\right\}
$$

式中, $B$ 为结构元素, $\left(S_{k}(X) \oplus k B\right)$ 代表连续 $k$ 次用 $B$ 对 $S_{k}(X)$膨胀, 即

$$
\left(S_{k}(X) \oplus k B\right)=\left(\left(\Lambda\left(S_{k}(X) \oplus B\right) \oplus B\right) \oplus \Lambda\right) \oplus B
$$

利用式(8-35)以及图像腐蚀、膨胀的算法可以编写程序实现形态学骨架抽取变换, 有兴趣的读者请参考书后的参考文献。图8-25给出了用形态学方法抽取图像骨架的一个实例。其中, 图 8-25(a)为一幅二值图像, 图8-25(b)为用 $3 \times 3$ 的结构元素 $S$ (原点在中心)得到的骨架, 图8-25(c)为用 $5 \times 5$ 的结构元素得到的骨架,图8-25(d)为用 $7 \times 7$ 的结构元素得到的骨架。注意图8-25(c)和(d)中由于模板较大叶柄没有保留下来。 

![image-20230404150714049](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230404150714049.png)

图8-25 骨架抽取示例
(a) 一幅二值图像； (b) 用3×3的结构元素S得到的骨架；
(c) 用5×5的结构元素得到的骨架； (d)用5×5的结构元素得到的骨架 