# 5.2 代数复原法

## 5.2.1非约束复原方法

由式(5-24)可得
$$
n=g-H f
$$
在对 $n$ 没有先验知识的情况下, 可以依据这样的最优准则, 即寻找一个 $\hat{f}$, 使得 $H \hat{f}$ 在最小二乘方误差的意义下最按近 $g$, 即要使 $n$ 的模或范数 (norm) 最小:
$$
\|n\|^2=n^T n=\|g-H \hat{f}\|^2=(g-H \hat{f})^T(g-\hat{H f})
$$
即优化目标为:
$$
L(\hat{f})=\|g-H \hat{f}\|^2
$$
如果我们在求最小值的过程中, 不做任何约束, 称这种复原为非约束复原。由极值条件
$$
\frac{\partial L(\hat{f})}{\partial \hat{f}}=0 \Rightarrow H^T(g-H \hat{f})=0
$$
解出 $\hat{f}$ 为
$$
\hat{f}=\left(H^T H\right)^{-1} H^T g
$$

## 5.2.2 约束复原法

非约束复原是指除了使准则函数 $L(\hat{f})=\|g-\hat{H f}\|^2$ 最小外, 再没有其他的约束条件。因此只需了解降质系统的传递函数或点扩展函数, 就能利用如前所述的方法进行复原。但是由于传递函数存在病态问题, 复原只能局限在靠近原点的有限区域内进行, 这使得非约束图像复原具有相当大的局限性。

最小二乘类约束复原是指除了要求了解关于退化系统的传递函数之外, 还需要知道某些噪声的统计特性或噪声与图像的某些相关情况。根据所了解的噪声的先验知识的不同, 采用不同的约束条件, 可得到不同的图像复原技术。在最小二乘类约束复原中, 要设法寻找一个最优估计 $\hat{f}$, 使得形式为 $\|Q \hat{f}\|^2=\|n\|^2$ 的函数最小化。求这类问题的最小化, 常采用拉格朗日乘子算法。也就说, 要寻找一个 $\hat{f}$, 使得优化目标函数:
$$
J(\hat{f})=\|\hat{O \hat{f}}\|^2+\alpha\left(\|g-H \hat{f}\|^2-\|n\|^2\right)
$$
为最小。式中, $Q$ 为 $\hat{f}$ 的线性算子, $\alpha$ 为一常数, 称为拉格朗日乘子。对式(5-30)求导得
$$
\begin{aligned}
& \frac{\partial J(\hat{f})}{\partial f}=0 \\
& Q^T Q \hat{f}-\alpha H^T(g-H \hat{f})=0
\end{aligned}
$$
求解 $\hat{f}$ 得到
$$
\hat{f}=\left(H^T H+\gamma Q^T Q\right)^{-1} H^T g
$$