# 2.7 小波变换简介

## 2.7.1 小波变换的理论基础

本质：任何信号都是由低频+高频信号合成可进一步分解

信号分析是为了获得时间和频率之间的相互关系。傅立叶变换提供了有关频率域的信息, 但有关时间的局部化信息却基本丢失。与傅立叶变换不同, 小波变换是通过缩放母小波 (Mother wavelet)的宽度来获得信号的频率特征， 通过平移母小波来获得信号的时间信息。对母小波的缩放和平移操作是为了计算小波系数, 这些小波系数反映了小波和局部信号之间的相关程度。 

### 连续小波变换(CWT)

像傅立叶分析一样, 小波分析就是把一个信号分解为将母小波经过缩放和平移之后的一系列小波, 因此小波是小波变换的基函数。小波变换可以理解为用经过缩放和平移的一系列小波函数代替傅立叶变换的正弦波和余弦波进行傅立叶变换的结果。

图7-13表示了正弦波和小波的区别, 由此可以看出, 正弦波从负无穷一直延续到正无穷, 正弦波是平滑而且是可预测的, 而小波是一类在有限区间内快速衰减到 0 的函数, 其平均值为 0 , 小波趋于不规则、不对称。 

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230427153813312.png" alt="image-20230427153813312" style="zoom:50%;" />

图2-13 正弦波和小波
(a)正弦波曲线; (b) 小波曲线 

从小波和正弦波的形状可以看出, 变化剧烈的信号, 用不规则的小波进行分析比用平滑的正弦波更好, 即用小波更能描述信号的局部特征。

连续小波变换 (Continuous Wavelet Transform, CWT) 用下式表示:

$$
C(\text { scale, position })=\int_{-\infty}^{+\infty} f(t) \psi( { scale, position, } t) d t
$$

式 (2-79) 表示小波变换是信号 $f(x)$ 与被缩放和平移的小波函数 $\psi()$ 之积在信号存在的整个期间里求和的结果。CWT的变换结果是许多小波系数 $C$, 这些系数是缩放因子 (scale) 和平移 (positon) 的函数。 

基本小波函数 $\psi()$ 的缩放和平移操作含义如下:

图2-14 小波的缩放操作 

(2) 平移。简单地讲, 平移就是小波的延迟或超前。在数学上, 函数 $f(t)$ 延迟 $k$ 的表达式为 $f(t-k)$, 如图2-15所示。

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230503095911885.png" alt="image-20230503095911885" style="zoom:50%;" />

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230503095952459.png" alt="image-20230503095952459" style="zoom:50%;" />

图2-15 小波的平移操作

(a) 小波函数 $\psi(t)$;  (b) 位移后的小波函数 $\psi(t-k)$ 

CWT计算主要有如下五个步骤:

1. 取一个小波, 将其与原始信号的开始一节进行比较。

2. 计算数值C, C表示小波与所取一节信号的相似程度, 计算结果取决于所选小波的形状, 如图2-16所示。

3. 向右移动小波, 重复第一步和第二步, 直至覆盖整个信号, 如图2-17所示。

4. 伸展小波, 重复第一步至第三步, 如图2-18所示。 

<img src="https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-08.jpg?height=877&width=1591&top_left_y=384&top_left_x=525" style="zoom: 25%;" />

图2-16 计算系数值 $C$ 

<img src="https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-09.jpg?height=868&width=1821&top_left_y=344&top_left_x=301" style="zoom: 25%;" />

图2-17 计算平移后系数值 $C$



<img src="https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-10.jpg?height=855&width=1515&top_left_y=389&top_left_x=505" style="zoom: 25%;" />

图2-18 计算尺度后系数值 $C$ 

5. 对于所有缩放，重复第一步至第四步。

小波的缩放因子与信号频率之间的关系是：缩放因子 scale
越小, 表示小波越窄, 度量的是信号的细节变化, 表示信号频率越高; 缩放因子scale越大, 表示小波越宽, 度量的是信号的粗䊁程度，表示信号频率越低。 

### 离散小波变换(DWT)

在每个可能的缩放因子和平移参数下计算小波系数, 其计算量相当大, 将产生惊人的数据量, 而且有许多数据是无用的。如果缩放因子和平移参数都选择为 $2^{j}(j>0$ 且为整数) 的倍数,即只选择部分缩放因子和平移参数来进行计算, 就会使分析的数据量大大减少。使用这样的缩放因子和平移参数的小波变换称为双尺度小波变换(Dyadic Wavelet Transform)，它是离散小波变换(Discrete Wavelet Transform，DWT)的一种形式。通常离散小波变换就是指双尺度小波变换。 

执行离散小波变换的有效方法是使用滤波器, 该方法是Mallat于1988年提出的，称为Mallat算法。这种方法实际上是一种信号分解的方法, 在数字信号处理中常称为双通道子带编码。

用滤波器执行离散小波变换的概念如图2-19所示。S表示原始的输入信号, 通过两个互补的滤波器组, 其中一个滤波器为低通滤波器, 通过该滤波器可得到信号的近似值 $A$(Approximations), 另一个为高通滤波器, 通过该滤波器可得到信号的细节值$D$(Detail)。



<img src="https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-14.jpg?height=1119&width=1623&top_left_y=279&top_left_x=423" style="zoom:50%;" />

图2-19 小波分解示意图 

在小波分析中，近似值是大的缩放因子计算的系数，表示信号的低频分量, 而细节值是小的缩放因子计算的系数, 表示信号的高频分量。实际应用中, 信号的低频分量往往是最重要的, 而高频分量只起一个修饰的作用。如同一个人的声音一样, 把高频分量去掉后, 听起来声音会发生改变, 但还能听出说的是什么内容, 但如果把低频分量删除后, 就会什么内容也听不出来了。 

由图2-19可以看出离散小波变换可以表示成由低通滤波器和高通滤波器组成的一棵树。原始信号经过一对互补的滤波器组进行的分解称为一级分解, 信号的分解过程也可以不断进行下去, 也就是说可以进行多级分解。如果对信号的高频分量不再分解, 而对低频分量进行连续分解, 就可以得到信号不同分辨率下的低频分量, 这也称为信号的多分辨率分析。如此进行下去, 就会形成图2-20所示的一棵比较大的分解树, 称其为信号的小波分解树 (Wavelet Decomposition Tree)。实际中，分解的级数取决于要分析的信号数据特征及用户的具体需要。 

<img src="https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-17.jpg?height=1527&width=2203&top_left_y=72&top_left_x=244" style="zoom:50%;" />

图2-20 多级信号分解示意图
(a) 信号分解； (b) 小波分数； (c)小波分解树 

<img src="C:/Users/16955/AppData/Roaming/Typora/typora-user-images/image-20230427160105238.png" alt="image-20230427160105238" style="zoom:50%;" />

图2-21 小波分解下采样示意图 

### 小波重构

将信号的小波分解的分量进行处理后, 一般还要根据需要

把信号恢复出来, 也就是利用信号的小波分解的系数还原出原始信号, 这一过程称为小波重构(Wavelet Reconstruction)或叫做小波合成(Wavelet Synthesis)。这一合成过程的数学运算叫做逆离散小波变换 ( Inverse Discrete Wavelet Transform, IDWT)。 

<img src="https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-21.jpg?height=1052&width=1872&top_left_y=297&top_left_x=320" style="zoom:50%;" />

图2-22 小波重构算法示意图 

#### 重构近似信号与细节信号

由图2-22可知, 由小波分解的近似系数和细节系数可以重构出原始信号。同样, 可由近似系数和细节系数分别重构出信号的近似值或细节值, 这时只要近似系数或细节系数置为零即可。

图2-23是对第一层近似信号或细节信号进行重构的示意图。 

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230427160213641.png" alt="image-20230427160213641" style="zoom:50%;" />

图2-23 重构近似和细节信号示意

(a)重构近似信号;  (b) 重构细节信号 

#### 多层重构

在图2-23中, 重构出信号的近似值 $A_{1}$ 与细节值 $D_{1}$ 之后, 则原信号可用 $A_{1}+D_{1}=S$ 重构出来。对应于信号的多层小波分解, 小波的多层重构如图2-24所示。由图2-24可见重构过程为: 
$$
A_3+D_3=A_2\\
A_2+D_2=A_1\\
A_1+D_1=S
$$
信号重构中, 滤波器的选择非常重要, 关系到能否重构出满意的原始信号。低通分解滤波器 (L) 和高通分解滤波器 (H) 及重构滤波器组 $\left(L^{\prime}\right.$ 和 $\left.H^{\prime}\right)$ 构成一个系统, 这个系统称为正交镜像滤波器(Quadrature Mirror Filters, QMF)系统, 如图7-25 所示。 

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230427160652742.png" alt="image-20230427160652742" style="zoom:50%;" />

图2-24 多层小波重构示意图 

![](https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-26.jpg?height=814&width=2408&top_left_y=403&top_left_x=49)

图2-25 多层小波分解和重构示意图

### 小波包分析

小波分析是将信号分解为近似与细节两部分, 近似部分又可以分解成第二层近似与细节, 可以这样重复下去。对于一个 $N$层分解来说， 有 $N+1$ 个分解信号的途径。而小波包分析的细节与近似部分一样, 也可以分解, 对于 $N$层分解, 它产生 $2 N$ 个不同的途径, 图2-26是一个小波包分解示意图。 

<img src="https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-28.jpg?height=756&width=2498&top_left_y=362&top_left_x=-2" style="zoom:50%;" />

图2-26 小波包分解示意图 

小波包分解也可得到一个分解树，称其为小波包分解树(Wavelet Packet Decomposition Tree)，＼cjkstart这种树是一个完整的二义树。小波包分解方法是小波分解的一般化，可为信号分析提供更丰富和更详细的信息。信号 $S$ 可表示为$AA_2+ADA_3+DDA_3+D_1$等。 

### 二维离散小波变换

二维离散小波变换是一维离散小波变换的推广，其实质上是将二维信号在不同尺度上的分解, 得到原始信号的近似值和细节值。由于信号是二维的, 因此分解也是二维的。分解的结果为：近似分量cA、水平细节分量 $cH$ 、垂直细节分量cV和对角细节分量cD。同样也可以利用二维小波分解的结果在不同尺度上重构信号。二维小波分解和重构过程如图2-27所示。 

<img src="C:/Users/16955/AppData/Roaming/Typora/typora-user-images/image-20230427160820730.png" alt="image-20230427160820730" style="zoom: 67%;" />

图2-27二维小波分解和重构过程示意图
(a)二维DWT;  (b) 二维IDWT 

## 2.7.2 离散小波变换在图像处理中的应用简介

### 用小波变换进行图像分解

使用小波变换完成图像分解的方法很多，例如，均匀分解 ( Uniform decomposition ) 、非均匀分解 ( Non-uniform decomposition)、八带分解(Octave-band decomposition)、小波包分解 (Wavelet-packer decomposition) 等。其中八带分解是使用最广的一种分解方法, 这种分解方法把低频部分分解成比较窄的频带, 而对每一级分解得到的高频部分不再进一步进行分解。 图2-28为八带分解示意图, 用于分解的原始图像采用Matlab提供的预存图像文件woman2.mat，小波基函数为 “haar"小波。图228 (c)是用Matlab的小波工具箱编程进行分解得到的图像。 

![image-20230427160902436](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230427160902436.png)

图2-28 八带分解示意图

(a) 一次二维DWT;  (b) 两次二维DWT;  (c) Woman二级分解图 

### 用小波变换进行图像处理

对静态二维数字图像，可先对其进行若干次二维DWT变换,

将图像信息分解为高频成分 $H 、 V$ 和 $D$ 和低频成分 $A$ 。对低频部分

A，由于它对压缩的结果影响很大，因此可采用无损编码方法,

如Huffman、DPCM等；对 $H 、 V$ 和 $D$ 部分，可对不同的层次采用不同策略的向量量化编码方法, 这样便可大大减少数据量, 而图像的解码过程冈好相反。整个编码、解码流程如图2-29所示。 

![](https://cdn.mathpix.com/cropped/2023_03_29_c6380eb52646648cbc7eg-35.jpg?height=587&width=2437&top_left_y=430&top_left_x=47)

图2-29 图像压缩编码、解码流程此外，还可以在对 $A 、 H 、 V$ 和 $D$ 部分编码后加上一个反馈环节，获取误差图像，并对其编码。这样压缩效果会更好。

近年来，基于小波变换发展起来的图像编码有嵌入式零树小波编码EZW(Embedded Zerotree Wavelet)及在EZW算法基础上改进的层树分级编码SPIHT( Set Parition In HierarchicalTrees) 和最佳截断嵌入码块编码EBCOT (Embedded Block Coding with Optimized Truncation ) 等。ISO/IEC JTC1 SC29 小组制定的 JPEG2000静态图像编码标准中的图像变换技术就采用了离散小波变换，这些编码的最大特点是在不丢失重要信息的同时，能以较高的比率压缩图像数据，并且其算法计算量小。