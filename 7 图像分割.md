[TOC]

# 第七章 图像分割

# 7.1 图像分割

## 7.1.1 概述

图像分割是将图像划分成若干个互不相交的小区域的过程， 小区域是某种意义下具有共同属性的像素的连通集合。如不同目标物体所占的图像区域、 前景所占的图像区域等。连通是指集合中任意两个点之间都存在着完全属于该集合的连通路径。对于离散图像而言，连通有4连通和8连通之分，如图7-1所示。 

![image-20230329162658738](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329162658738.png)

图7-1 4连通和8连通

​    4连通指的是从区域上一点出发，可通过4个方向，即上、 下、左、右移动的组合，在不越出区域的前提下，到达区域内的任意像素； 8连通方法指的是从区域上一点出发，可通过左、 右、上、下、左上、右上、左下、右下这8个方向的移动组合来到达区域内的任意像素。

​    图像分割有三种不同的途径：其一是将各像素划归到相应物体或区域的像素聚类方法, 即区域法；其二是通过直接确定区域间的边界来实现分割的边界方法；其三是首先检测边缘像素， 再将边缘像素连接起来构成边界形成分割。在图像分割技术中， 最常用的是利用阈值化处理进行的图像分割。 

## 7.1.2 灰度阈值法分割

常用的图像分割方法是把图像灰度分成不同的等级, 然后用设置灰度门限 (阈值) 的方法确定有意义的区域或分割物体的边界。常用的阈值化处理就是图像的二值化处理, 即选择一阈值, 将图像转换为黑白二值图像, 用于图像分割及边缘跟踪等预处理。

图像阈值化处理的变换函数表达式为

$$
g(x, y)= \begin{cases}0 & f(x, y)<T \\ 255 & f(x, y) \geq T\end{cases}
$$

或
$$
g(x, y)= \begin{cases}1 & f(x, y) \leq t \\ 0 & f(x, y) \geq t\end{cases}
$$
或
$$
g(x, y)=\left\{\begin{array}{lr}
1 & t_1 \leq f(x, y) \leq t_2 \\
0 & \text { 其它 }
\end{array}\right.
$$




<img src="https://cdn.mathpix.com/cropped/2023_03_28_fadf0bb279ca899c9bb6g-07.jpg?height=1015&width=1260&top_left_y=312&top_left_x=684" style="zoom: 33%;" />

图7-2 阈值变换曲线

在图像的阈值化处理过程中， 选用不同的阈值其处理结果差异很大。如图7-3所示, 阈值过大, 会提取多余的部分; 而阈值过小, 又会丢失所需的部分（注意: 当前背景为黑色, 对象为白色时刚好相反）。因此, 阈值的选取非常重要。

图7-3(a)原始图像的直方图如图7-4所示。分析该直方图可知, 该直方图具有双峰特性, 图像中的目标 (细胞) 分布在较暗的灰度级上形成一个波峰, 图像中的背景分布在较亮的灰度级上形成另一个波峰。此时, 用其双峰之间的谷低处灰度值作为阈值 $T$ 进行图像的阈值化处理, 便可将目标和背景分割开来。 

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329163439909.png" alt="image-20230329163439909" style="zoom:50%;" />

图7-3 不同阈值对阈值化结果的影响
(a) 原始图像;
(b) 阈值 $T=91$;
(c) 阈值 $T=130$;
(d) 阈值 $T=43$ 

![image-20230329163518090](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329163518090.png)

图7-4 图7-3(a)所示图像的直方图 

   为了有效地分割物体与背景，人们发展了各种各样的阈值处理技术，包括全局阈值、自适应阈值、最佳阈值等等。从方法分有:直方图阈值分割法, 类间方差阈值分割法,二维熵值分割法,模糊阈值分割法,共生矩阵阈值分割法.


 - 全局阈值
全局阈值是指整幅图象使用同一个阈值做分割处理。适用于背景和前景有明显对比的图象。 例如当直方图明显呈现双峰情况时, 可以选择两个峰值的中点作为全局阈值。 

- 自适应阈值
在许多情况下, 物体和背景的对比度在图象中不是各处一样的, 这时很难用统一的一个阈值将物体与背景分开。这时可以根据图象的局部特征分别采用不同的阈值进行分割。实际处理时, 需要按照具体问题将图象分成若干子区域分别选择阈值, 或者动态地根据一定的邻域范围选择每点处的阈值, 进行图象分割。

- 最佳阈值
最佳阈值是使图像中目标与背景分割错误最小的阈值。

1.直方图阈值分割法 

1)简单直方图分割法 

基本原理: 直方图明显呈现双峰情况时，可以选择两个峰值的中点作为阈值.
![](https://cdn.mathpix.com/cropped/2023_03_28_fadf0bb279ca899c9bb6g-13.jpg?height=668&width=2282&top_left_y=922&top_left_x=96)

![image-20230329163751193](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329163751193.png)


2) 最佳阈值

设一幅图像只由目标和背景组成,其灰度分布概率密度 $P_{1}(\mathbf{z})$ 和 $\mathbf{P}_{2}(\mathbf{z})$ 为正态分布,且已知目标像素占全图像像素比为 $\theta$ :

$p$

![](https://cdn.mathpix.com/cropped/2023_03_28_fadf0bb279ca899c9bb6g-15.jpg?height=587&width=1311&top_left_y=861&top_left_x=531)



$$
P_{1}(Z)=\frac{1}{\sqrt{2 \pi \sigma_{1}}} \exp \left[-\frac{\left(Z-\mu_{1}\right)^{2}}{2 \sigma_{1}{ }^{2}}\right]
$$

$$
P_{2}(Z)=\frac{1}{\sqrt{2 \pi \sigma_{2}}} \exp \left[-\frac{\left(Z-\mu_{2}\right)^{2}}{2 \sigma_{2}{ }^{2}}\right]
$$

则阈值为:

$$
Z_{t}=\frac{\mu_{1}+\mu_{2}}{2}+\frac{\sigma^{2}}{\mu_{1}-\mu_{2}} \ln \left(\frac{1-\theta}{\theta}\right)
$$

若 $\theta=0.5$

则阈值为:

$$
Z_{t}=\frac{\mu_{1}+\mu_{2}}{2}
$$



2.类间方差阈值分割法 

设一幅图像只由目标和背景组成,原图灰度级为} $L$, 灰度级为 $i$ 的像素点数为 $n_{i}$, 图像总像素点数为 $N$, 则:
$$
p_{i}=\frac{n_{i}}{N}
$$

用阈值 $t$ 将图像分割为两类: $C_{1}=(0,1,2, \ldots, t)$ 和 $C_{2}$ $=(\mathbf{t}, \mathbf{t}+1, \mathbf{t}+2, \ldots, \mathbf{L}-1)$, 则有：



$$
\begin{aligned}
& \omega_{1}=P_{r}\left(C_{1}\right)=\sum_{i=0}^{t} p_{i} \\
& \omega_{2}=P_{r}\left(C_{2}\right)=\sum_{i=t+1}^{L-1} p_{i} \\
& \mu_{1}=\sum_{i=0}^{t} i p_{i} / \omega_{1} \\
& \mu_{2}=\sum_{i=t+1}^{L-1} i p_{i} / \omega_{2} \\
& \sigma_{1}^{2}=\sum_{i=0}^{t}\left(i-\mu_{1}\right)^{2} p_{i} / \omega_{1} \\
& \sigma_{2}^{2}=\sum_{i=t+1}^{L-1}\left(i-\mu_{2}\right)^{2} p_{i} / \omega_{2}
\end{aligned}
$$

类内方差:

$$
\sigma_{\omega}^{2}=\omega_{1} \sigma_{1}^{2}+\omega_{2} \sigma_{2}^{2}
$$

类间方差:

$$
\sigma_{B}^{2}=\omega_{1} \omega_{2}\left(\mu_{1}-\mu_{2}\right)^{2}
$$

总方差:

$$
\sigma_{\omega}^{2}=\sigma_{B}^{2}+\sigma_{\omega}^{2}
$$

定义准则函数:

$$
F(t)=\sigma_{B}^{2} / \sigma_{T}^{2}
$$



则使 $F(t)$ 最大的 $t$ 为最佳阈值.

![](https://cdn.mathpix.com/cropped/2023_03_28_fadf0bb279ca899c9bb6g-20.jpg?height=845&width=1208&top_left_y=445&top_left_x=525)

图 6.3.6 坦克图类间方差阈值分割 

3二维熵值分割法

一维熵值分割法设原图灰度级为 $L$, 灰度级为 $i$ 的像素点数为 $n_{i}$, 图像总像素点数为 $\mathbf{N} \times \mathbf{N}$,则:

$$
p_{i}=\frac{n_{i}}{N \times N}
$$

设图中灰度级低于 $t$ 的像素点构成目标区域O, 灰度级高于 $\mathbf{t}$ 的像素点构成背景区域B, 则目标区域和背景区域的熵定义为:

$H_{0}(t)=-\sum_{i}\left(p_{i} / p_{t}\right) \lg \left(p_{i} / p_{t}\right) \quad i=1,2,3 \cdots t$

$$
H_{B}(t)=-\sum_{i}\left[p_{i} /\left(1-p_{t}\right)\right] \lg \left[p_{i} /\left(1-p_{t}\right)\right] \quad i=t+1, t+2, t+3 \cdots L-1
$$

贝则熵函数定义为:

$$
\varphi(t)=H_{0}+H_{B}=\lg p_{t}\left(1-p_{t}\right)+\frac{H_{t}}{p_{t}}+\frac{H_{L}-H_{t}}{1-p_{t}}
$$

其中:

$$
\begin{array}{cc}
H_{t}=-\sum_{i} p_{i} \lg p_{i} & i=1,2, \cdots t \\
H_{L}=-\sum_{i} p_{i} \lg p_{i} & i=1,2 \cdots L
\end{array}
$$

当熵函数最大时的灰度值t就为最佳阈值.



4.模糊阈值分割

1)隶属函数 $\mu\left(x_{m, n}, p, \mathbf{q}\right)$ :

设像素点 $(m, n)$ 的灰度值为 $x_{m, n}$, 则 $\mu\left(x_{m, n}, p, q\right)$ 定义为像素点 $(m, \mathbf{n})$ 属于目标的程度;

$$
\mu\left(x_{m, n}, p, q, r\right)=\left\{\begin{array}{cc}
0 & x_{m, n} \leq p \\
2\left[\left(x_{m, n}-p\right) /(r-p)\right]^{2} & p \leq x_{m, n} \leq q \\
1-2\left[\left(x_{m, n}-p\right) /(r-p)\right]^{2} & q_{m, n}<x \leq r \\
1 & x \geq r
\end{array}\right.
$$

或
$$
\mu\left(x_{m, n}, p, q, r\right)=\left\{\begin{array}{cc}
0 & x_{m, n} \leq p \\
\dfrac{K\left(x_{m, n}-p\right)^{2}}{1+K\left(x_{m, n}-p\right)^{2}} & p<x_{m, n} \leq q \\
1 & x_{m, n}>q
\end{array}\right. \\
$$
或
$$
\mu\left(x_{m, n}, p, q, r\right)=\left\{\begin{array}{cc}
0 & x_{m, n} \leq p \\
\dfrac{\left(x_{m, n}-p\right)}{q-p} & p<x_{m, n} \leq q \\
1 & x_{m, n}>q
\end{array}\right.
$$
其中 $\mathbf{q}$ 为阈值, 显然灰度值越大, 隶属函数 $\mu\left(x_{m, n}, p, q\right)$ 越大, 该点 $(\mathbf{m}, \mathbf{n})$ 属于目标的程度, 即该点越可能是目标上的点,否则该点越可能是背景上的点.



2 ）模糊率、模糊熵:

模糊率

$$
V(q)=\frac{2}{M N} \sum_{m} \sum_{n} \min \left[\mu\left(x_{m, n}, q\right), 1-\mu\left(x_{m, n}, q\right)\right]
$$

模糊熵

$$
\begin{aligned}
& E(q)=\frac{1}{M N \ln 2} \sum_{m} \sum_{n} S_{n}\left[\mu\left(x_{m, n}, q\right)\right] \\
& S_{n}\left[\mu\left(x_{m, n}, q\right)\right]=-\mu\left(x_{m, n}, q\right) \ln \mu\left(x_{m, n}, q\right)-\left(1-\mu\left(x_{m, n}, q\right) \ln \left(1-\mu\left(x_{m, n}, q\right)\right)\right.
\end{aligned}
$$

3）模糊阈值

当模糊率或模糊熵最大时的灰度值 $\mathbf{q}$ 就为最佳阈值.}



<img src="https://cdn.mathpix.com/cropped/2023_03_28_fadf0bb279ca899c9bb6g-26.jpg?height=1062&width=1515&top_left_y=241&top_left_x=499" style="zoom:50%;" />

图 6.3.13 坦克图模糊阈值法分割 

## 7.1.3 区域生长

分割的目的是把一幅图像划分成一些区域，最直接的方法就是把一幅图像分成满足某种判据的区域，也就是说，把点组成区域。为了实现分组, 首先要确定区域的数目, 其次要确定一个区域与其他区域相区别的特征, 最后还要产生有意义分割的相似性判据。

分割区域的一种方法叫区域生长或区域生成。假定区域的数目以及在每个区域中单个点的位置已知, 则从一个已知点开始，加上与已知点相似的邻近点形成一个区域。相似性准则可以是灰度级、 彩色、组织、梯度或其他特性，相似性的测度可以由所确定的阈值来判定。方法是从满足检测准则的点开始， 在各个方向上生长区域, 当其邻近点满足检测准则就并入小块区域中。当新的点被合并后再用新的区域重复这一过程, 直到没有可接受的邻近点时生成过程终止。 

图 7-5给出一个简单的例子。此例的相似性准则是邻近点的灰度级与物体的平均灰度级的差小于2。图中被接受的点和起始点均用下划线标出，其中（a）图是输入图像;（b）图是第一步接受的邻近点;（c）图是第二步接受的邻近点;(d) 图是从6开始生成的结果。 

![image-20230329164234265](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329164234265.png)

图7-5 区域生长示例 

当生成任意物体时，接收准则可以结构为基础, 而不是以灰度级或对比度为基础。为了把候选的小群点包含在物体中,可以检测这些小群点, 而不是检测单个点, 如果它们的结构与物体的结构足够相似时就接受它们。 

## ７.1.4 区域聚合

区域聚合可直接用于图像分割, 它要求聚合中的各个点必须在平面上相邻接而且特性相似。区域聚合的步骤是首先检查图像的测度集，以确定在测度空间中聚合的位置和数目，然后把这些聚合的定义用于图像, 以得到区域聚合。区域聚合技术可以说明如下。

首先, 在图片上定义某个等价关系。例如, 最简单的等价关系可定义为 $p(i, j)=p(k, l)$ 。也就是说, 如果 $p(i, j)=p(k, l)$, 就说明 $p(i, j)$ 与 $p(k, l)$ 等价。任何在点的格子上的等价关系又可划分为等价类。例如, $p(i, j)$ 的取值范围为 0 到 63 , 就可以产生 64 个等价类的模板。如果关系满足，它的值等于 1 ，否则为 0 。

模板的图像是两两不相交的, 那么64个模板就会充满整个格子。这些等价的类又可进一步分为最大连接的子集（连接分量）。连接性可以用点 $(i, j)$ 的邻点来定义, 如4连通邻点、8连通邻点等等。假如 $R$ 是属于格子的子集, 在 $R$ 中存在一个点序列, 第一个点是 $p_{1}$, 最后一个点是 $p_{2}$, 属于格子的子集 $R$ 的两个点 $p_{1}$ 和 $p_{2}$ 是被连接起来的, 这样, 相继的各点是 4 连接相邻的。通过这样的连接关系可以定义一个属于 $R$ 的子集, 这个子集形成一个区域, 在这个区域中, 任何点都与 $R$ 有关。利用等价模板可分成最大的连接区域, 然后, 这些最大的连接区域又可以像搭积木一样形成有意义的分割。 

1970年布莱斯和芬尼玛提出一种分割方法, 如图5-6所示。图 ( $a$ ) 是具有灰度级的 $3 \times 3$ 的 $G$ 阵列, 图 (b) 是对 $G$ 的分割结果。 其中, 图像格子为 $G$, 它是大格子 $S$ 的子格子。 $G$ 为 $n \times m$ 的格子, $S$ 是 $(2 n+1) \times(2 m+1)$ 的大格子。在大格子中, $G(i, j)$ 点位于 $S$ 的 $(2 i+1,2 j+1)$ 点上。 $G$ 中的点与 $S$ 中的点相对应, 其中每一下标都是奇数, 其余的点用来代表区域的边界。以这种形式表现的区域, 产生一种寻找最大连接区域的方法。G中的点与它上边和右边的点相比较, 灰度级相同就合并, 灰度级不同就揷入边界线。把图像中的每个点都处理过之后, 整个图像就被分割成区域。 在这个例子中, 由于采用了4连通等价关系, 因此, 由图可见, 在对角线方向上的等灰度级产生了隔开的区域。 

![image-20230329164903486](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329164903486.png)

图７-6 布莱斯和芬尼玛分割方法 

2 分裂合并法

实际中常先把图像分成任意大小且不重叠的区域，然后再合并或分裂这些区域以满足分割的要求, 即分裂合并法. 一致性测度可以选择基于灰度统计特征 (如同质区域中的方差)，假设阈值为 $T$, 则算法步骤为:

(1) 对于任一 $R_{i}$, 如果 $V\left(R_{i}\right)>T$ ，则将其分裂成互不重叠的四等分;

(2) 对相邻区域 $R_{i}$ 和 $R_{j}$, 如果 $\boldsymbol{V}\left(\boldsymbol{R}_{i} \bigcup_{j} \boldsymbol{R}\right)<T$, 则将二者合并;

(3) 如果进一步的分裂或合并都不可能了, 则终止算法。 

2 分裂合并法

![image-20230329164936784](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329164936784.png)



# 7.2 边缘检测

当物体与背景有明显对比度时，物体的边界处于图象梯度最高的点上，通过跟踪图象中具有最高梯度的点的方式获得物体的边界, 可以实现图象分割。

这种方法容易受到噪声的影响而偏离物体边界, 通常需要在跟踪前对梯度图象进行平滑等处理，再采用边界搜索跟踪算法来实现。

在Marr的视觉计算理论框架中, 抽取二维图像上的边缘、 角点、纹理等基本特征, 是整个系统框架中的第一步。这些特征所组成的图称为基元图。Yuille 等指出, 在不同 “尺度” 意义下的边缘点, 在一定条件下包含了原图像的全部信息。图5-7画出了一幅图像中的边缘点, 仅仅根据这些边缘点, 就能识别出三维物体，可见边缘点确实包含了图像中的大量信息。



![](https://cdn.mathpix.com/cropped/2023_03_28_6116f4e0e226f2060611g-07.jpg?height=1062&width=1387&top_left_y=279&top_left_x=525)

图5-7 图像中的边缘点 

(1) 空间曲面上的不连续点。如标为 $A$ 的边缘线, 这些边缘线为两个不同曲面的或平面的交线, 该点处物体表面的法线方向不连续, 在 $A$ 类边缘线的两边, 图像的灰度值有明显的不同。

（2）B类边缘线。B类边缘线是由不同材料或相同材料不同颜色产生的。图中桌面由两种不同材料组成, 由于它们对光的反射系数不同，使 $B$ 边缘线的两侧灰度有明显不同。 

(3) $C$ 类边缘线。C类边缘线是物体与背景的分界线。如图中圆柱上有两条 $C$ 类边缘线, 这类边缘线一般称为外轮廓线。在 $C$ 类边缘点上, 三维物体表面的法线方向是连续的, 出现边缘点是由于从一定视角看物体时, $C$ 类边界点是物体与背景的交界处。 由于物体与背景在光照条件与材料反射系数等方面差异很大, 因此在 $C$ 类边缘两侧, 图像的灰度也有很大差异。图中标以 $C^{\prime}$ 的边缘, 即是物体与背景的交界处, 也是物体上表面法线的不连续处，但引起它两侧灰度跃变的原因是前者。

（4）D边缘。D是阴影引起的边缘。由于物体表面某一部分被另一物体遮挡, 使它得不到光源的照射, 从而引起边缘点两侧灰度值有较大的差异。 

## 7.2.1 边缘检测与微分运算

如前所述, 边缘点是信号 “变化剧烈” 的地方, 但这么说并不准确, 需要定义一个准确的边缘数学模型。以一维信号为例,图 7-8（a）是一种阶跃信号, 我们当然认为 $A$ 点处为边缘点。在实际情况中，物理信号不可能有理想的突变，而是如图 7-8（b） 所示的逐渐增大的信号, 对图 $7-8$ ( $b$ ) 中所示 $A 、 B 、 C$ 三点, 一般称 $B$ 点为边缘点。在图 $7-8(c)$ 和 $7-8(d)$ 中，如果台阶比较窄, 即可以认为 $B$ 点为边缘点, 也可以认为该信号有两个边缘点 $A$ 与 $C$ 。 

![image-20230329165152665](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329165152665.png)

图７-8 不同的边缘信号

![image-20230329165210101](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329165210101.png)

图 7-9 图像中不同类型的边界
（a）边界;
(b) 线;
（c）折线变化;
（d）缓慢的平滑变化 
![](https://cdn.mathpix.com/cropped/2023_03_28_6116f4e0e226f2060611g-13.jpg?height=976&width=1806&top_left_y=322&top_left_x=332)

图 7 -10 用Prewitt算子进行边缘检测的结果 

## 5.2.2 高斯-拉普拉斯(LOG)算子

噪声点对边缘检测有较大的影响, 效果更好的边缘检测器是高斯-拉普拉斯(LOG)算子。它把高斯平滑滤波器和拉普拉斯锐化滤波器结合起来, 先平滑掉噪声, 再进行边缘检测, 所以效果更好。

常用的LOG算子是 $5 \times 5$ 的模板:

$$
\left[\begin{array}{ccccc}
-2 & -4 & -4 & -4 & -2 \\
-4 & 0 & 8 & 0 & -4 \\
-4 & 8 & 24^{*} & 8 & -4 \\
-4 & 0 & 8 & 0 & -4 \\
-2 & -4 & -4 & -4 & -2
\end{array}\right]
$$



![](https://cdn.mathpix.com/cropped/2023_03_28_6116f4e0e226f2060611g-15.jpg?height=1008&width=1754&top_left_y=287&top_left_x=421)

图７-11 LOG算子中心点的距离与位置加权系数的关系 

若将图 7 -11绕y轴作旋转一周后, LOG算子很像一顶墨西哥草帽，所以，LOG又叫墨西哥草帽滤波器。在图像边缘检测中， 还有Wallis算子、过零点检测（Marr-Hildreth算子）、Canny边缘检测方法、SUSAN（Smallest Univalue Segment Assimilating Nucleus）边缘检测等。

在边缘图象的基础上，需要通过平滑、形态学等处理去除噪声点、毛刺、空洞等不需要的部分，再通过细化、边缘连接和跟踪等方法获得物体的轮廓边界。 


![](https://cdn.mathpix.com/cropped/2023_03_28_6116f4e0e226f2060611g-17.jpg?height=1006&width=1328&top_left_y=662&top_left_x=582)

# 7.3 轮廓跟踪与提取

## 7 .3.1 轮廓跟踪

在识别图像中的目标时，往往需要对目标边缘作跟踪处理，也叫轮廓跟踪。顾名思义, 轮廓跟踪就是通过顺序找出边缘点来跟踪边界的。若图像是二值图像或图像中不同区域具有不同的像素值，但每个区域内的像素值是相同的，则如下算法可完成基于4连通或8连通区域的轮廓跟踪。

步骤1：首先按从上到下, 从左到右的顺序扫描图像, 寻找没有标记跟踪结束记号的第一个边界起始点 $A 0, ~A 0$ 是具有最小行和列值的边界点。定义一个扫描方向变量dir, 该变量用于记录上一步中沿着前一个边界点到当前边界点的移动方向, 其初始化取值为
(1) 对4连通区域取dir = 3, 如图 7 -12(a) 所示;
(2) 对8连通区域取dir = 7, 如图 7 -12(b)所示。 

![image-20230329165554406](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329165554406.png)

图７-12 方向变量的初始化

(b) 步骤2：按逆时针方向搜索当前像素的 $3 \times 3$ 邻域, 其起始搜索方向设定如下:

(1) 对4连通区域取(dir + 3)mod 4， 如图 7 -13(a)所示;

(2) 对8连通区域, 若dir为奇数取(dir + 7)mod 8, 如图 7 -

13(b)所示; 若dir为偶数取(dir + 6) $\bmod 8$, 如图 $7-13$ (c)所示。 

![image-20230329165626747](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230329165626747.png)

图 7-13 3×3邻域起始搜索方向 

在3×3邻域中搜索到的第一个与当前像素值相同的像素便为新的边界点 $A_{n}$, 同时更新变量dir为新的方向值。

步骤3: 如果 $A_{n}$ 等于第二个边界点 $A_{1}$ 且前一个边界点 $A_{n-1}$ 等于第一个边界点 $A_{0}$, 则停止搜索, 结束跟踪, 否则重复步骤2继续搜索。

步骤4: 由边界点 $A_{0} 、 A_{1} 、 A_{2} 、 \ldots 、 A_{n-2}$ 构成的边界便为要跟踪的边界。

算法中步骤1中所采用的准则称为 “探测准则”，其作用是找出第一个边界点；步骤3中所采用的准则称为 “跟踪准则”， 其作用是找出所有边界点。 
![](https://cdn.mathpix.com/cropped/2023_03_28_6116f4e0e226f2060611g-24.jpg?height=572&width=2100&top_left_y=410&top_left_x=244)

图 7-14 轮廓跟踪示例 

## 7.3.2 轮廓提取

二值图像轮廓提取的算法非常简单，就是掏空内部点: 如

果原图像中有一点为黑, 且它的8个邻点都是黑色时, 说明该点是内部点, 将该点删除（置为白色像素值255）。对图像中所有像素点执行该操作便可完成图像轮廓的提取。 

# 7.4 Hough 变换

对于图象中某些符合参数模型的主导特征, 如直线、圆、椭圆等, 可以通过对其参数进行聚类的方法，抽取相应的特征。

Hough变换[Hough，1962]是一种基于图像全局分割结果的边缘连接技术, 它抗干扰能力强, 能检测出任意形状的曲线, 即使线上有许多的断裂, 因此在图像分析的预处理中获得广泛应用。 

1 ) 抽取线条特征

直线在极坐标系下具有如下的参数方程形式:

$$
\rho=x \cos \theta+y \sin \theta \quad(7.2)
$$

这表明图像空间的一点（x,y）对应于 $(\rho, \theta)$ 空间的一条正弦曲线，其相位和幅值由 $\mathbf{x} 、 \mathbf{y}$ 决定。
![](https://cdn.mathpix.com/cropped/2023_03_28_6116f4e0e226f2060611g-27.jpg?height=546&width=1366&top_left_y=1002&top_left_x=525)

图 7-15 点的Hough变换的极坐标形式 

$(x, y)$ 空间的同一条直线上的点在 $(\rho, \theta)$ 空间的正弦曲线都会相交于点 $\left(\rho_{0}, \theta_{0}\right), \rho_{0}$ 为这条直线到原点的距离, $\theta_{0}$ 为直线的法线与轴的夹角.
![](https://cdn.mathpix.com/cropped/2023_03_28_6116f4e0e226f2060611g-28.jpg?height=526&width=1468&top_left_y=745&top_left_x=630)

图 7-16 共线点Hough变换的极坐标形式 

首先将参数空间 $(\rho, \theta)$ 量化为等间隔的小区域,然后针对超过给定阈值的所有边缘点, 对于每个$(\boldsymbol{p}, \boldsymbol{\theta})$ 将其映射到的参数空间中的小区域中, 记数落到每个小区域的点数。最后, 取具有最大频度的若干小区域的参数作为线条特征的参数, 得到图象中主导性的线条特征。

![](https://cdn.mathpix.com/cropped/2023_03_28_6116f4e0e226f2060611g-29.jpg?height=497&width=641&top_left_y=1142&top_left_x=1044)

### 算法

1) 将 $(\rho, \theta)$ 空间量化, 得到二维矩阵 $M(\rho, \theta)$, $M(\rho, \theta)$ 是一个累加器, 初始值为 $0, M(\rho, \theta)=0$ 。

2 ) 对边界上的每一个点 $\left(x_{i}, y_{i}\right)$, 将 $\theta$ 的所有量化值代入式 ( 7-2), 计算相应的 $\rho$, 并且将累加器加1, $M(\rho, \theta)=M(\rho, \theta)+1$ 。

3) 将全部 $\left(x_{i}, y_{i}\right)$ 处理后, 分析 $M(\rho, \theta)$, 如果 $M(\rho, \theta) \geq T$, 就认为存在一条有意义的线段, 是该线段的拟合参数。 $T$ 是一个非负整数, 由图像中景物的先验知识决定。

4) 由 $(\rho, \theta)$ 和 $\left(x_{i}, y_{i}\right)$ 共同确定图像中的线段, 并将断裂部分连接。 

2 ）抽取圆特征$$
(x-a)^{2}+(y-b)^{2}=r^{2}


1. 固定r, 首先将参数空间 $(a, b)$ 量化为等间隔的小区域, 然后针对超过给定阈值的所有边缘点, 对于每个(a,b)将其映射到的参数空间中的小区域中, 记数落到每个小区域的点数。最后, 取具有最大频度的若干小区域的参数作为圆特征的参数;

2 . $r$ 取不同值, 重复第一步; 最大频度对应参数即为图象中圆参数。}



图像分割小结

1、图像分割是将一幅数字图像划分为不交叠的、连通的像素集的过程, 其中一个对应于背景, 其他的则对应于图像中的各个物体。

2、图像分割可以通过为物体指定其像素或找出物体之间的（或物体和背景之间的）边界的方法来实现。 3 、灰度级阈值处理是一种总能产生闭合的连通边界的简单分割技术。

4 、在分割之前进行背景的平滑和噪声消除, 常常能改善分割的性能。 5 、阈值的大小应当根据图像的内容变化，除非背景灰度级和物体的对比度相对恒定。

6、具有简单物体以及与背景对比度明显的图像， 将阈值置于双峰直方图的低䏌可使物体面积对阈值变化的敏感度最小。

7、物体分割可以通过在梯度图像中进行边界跟踪或阈值处理来实现。

8 、对一幅图像的分割可以用隶属关系图、边界链码、或线段编码来实现。