# 5.6 其他图像复原技术 

## 5.6 几何畸变校正

数字图像在获取过程中，由于成像系统的非线性，成像后的图像与原景物图像相比，会产生比例失调，甚至扭曲，我们把这类图像退化现象称之为几何畸变。典型的几何失真如图5-4所示。 

<img src="C:/Users/16955/AppData/Roaming/Typora/typora-user-images/image-20230426164500568.png" alt="image-20230426164500568" style="zoom: 67%;" />

图5-4 几种典型的几何失真
(a) 原图像； (b) 梯形失真； (c) 枕形失真； (d) 桶形失真 

一般，几何畸变校正要对失真的图像进行精确的几何校正， 通常是先确定一幅图像为基准，然后去校正另一幅图像的几何形状。因此，几何畸变校正一般分两步来做：第一步是图像空间坐标的变换；第二步是重新确定在校正空间各像素点的取值。 

### 空间几何坐标变换

按照一幅标准图像 $g(u, v)$ 或一组基准点去校正另一幅几何失真图像 $f(x, y)$, 称之为空间几何坐标变换。根据两幅图像的一些 已知对应点对(也称为控制点对)建立起函数关系式, 将失真图像的 $x-y$ 坐标系变换到标准图像 $u-v$ 坐标系, 从而实现失真图像按标准图像的几何位置校正, 使 $f(x, y)$ 中的每一像点都可在 $g(u, v)$ 中找到对应像点。

### 三角形线性法

图像的几何失真虽然是非线性的，但在一个局部小区域内可近似认为是线性的，基于这一假设，将标准图像和被校正图像之间的对应点对划分成一系列小三角形区域，三角形顶点为三个控制点， 在三角形区内满足以下线性关系： 
$$
\left\{\begin{array}{l}
x=a u+b v+c \\
y=d u+e v+f
\end{array}\right.\tag{5-52}
$$
若三对控制点在两个坐标系中的位置分别为 $\left(x_1, y_1\right) 、\left(x_2, y_2\right)$ 、 $\left(x_3, y_3\right)$ 和 $\left(u_1, v_1\right) 、\left(u_2, v_2\right) 、\left(u_3, v_3\right)$, 则可建立两级方程组:
$$
\left\{\begin{array}{l}
x_1=a u_1+b v_1+c \\
x_2=a u_2+b v_2+c \\
x_3=a u_3+b v_3+c
\end{array}\right.\tag{5-53a}
$$

$$
\left\{\begin{array}{l}
y_1=d u_1+e v_1+f \\
y_2=d u_2+e v_2+f \\
y_3=d u_3+e v_3+f
\end{array}\right.\tag{5-53b}
$$

解方程组(5-53)，可求出a, b, c, d, e, f六个系数。用式(5-53)可实现该三角形区内其他像点的坐标变换。对于不同的三角形控制区域，这六个系数的值是不同的。
三角形线性法简单，能满足一定的精度要求，这是因它是以局部范围内的线性失真去处理大范围内的非线性失真， 所以选择的控制点对越多，分布越均匀，三角形区域的面积越小， 则变换的精度越高。但是控制点过多又会导致计算量的增加， 因此需要综合考虑。 

### 灰度值的确定

图像经几何位置校正后，在校正空间中各像点的灰度值等于被校正图像对应点的灰度值。一般校正后的图像某些像素点可能挤压在一起，或者分散开，不会恰好落在坐标点上，因此常采用内插法来求得这些像素点的灰度值。经常使用的方法有如下两种。

1) 最近邻点法
最近邻点法是取与像素点相邻的4个点中距离最近的邻点灰度值作为该点的灰度值。如图5-5所示。显然，最近邻点法计算简单，但精度不高，同时校正后的图像亮度有明显的不连续性。 

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230426164921878.png" alt="image-20230426164921878" style="zoom:50%;" />

图5-5 最近邻点法 

2. 内插法
   用像素点周围４个邻点的灰度值加权内插作为g(u0, v0)，如图5-6所示，设像素点(x0, y0)周围４个点为$(x_1, y_1),  (x_1+1, y_1),  (x_1, y_1+1),  (x_1+1, y_1+1)$，则校正值为 

$$
\begin{aligned}
g\left(u_0, v_0\right)= & (1-\alpha)(1-\beta) f\left(x_1, y_1\right)+\alpha(1-\beta) f\left(x_1+1, y_1\right) \\
& +(1-\alpha) \beta f\left(x_1, y_1+1\right)+\alpha \beta f\left(x_1+1, y_1+1\right)
\end{aligned}\tag{5-54}
$$

式中：
$$
\alpha=\left|x_0-x_1\right|, \beta=\left|y_0-y_1\right|
$$
<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230426165105630.png" alt="image-20230426165105630" style="zoom:50%;" />

图5-6 内插法几何校正

## 5.6.2 盲目图像复原

盲目图像复原法是在没有图像退化先验知识的情况下，对观察目标的多幅图像以某种方式抽出退化信息， 从而进行图像复原的方法。
加性噪声的模糊图像复原方法一般有两种： 直接测量法和间接估计法。
用直接测量法复原图像时，需要测量图像的模糊脉冲响应和噪声功率谱或协方差函数。在所观察的景物中，点光源能量往往直接指示出冲激响应；另外，图像边缘是否陡峭也能用来推测模糊冲激响应。在背景亮度相对恒定的区域内测量图像的协方差，可以估计出观测图像的噪声协方差函数。 

间接估计法复原图像类似于多图像平均法处理。如对一个景物连续拍摄 $N$ 次, 每一次获取的图像用下式表示:
$$
g_i(x, y)=f(x, y)+n_i(x, y) \quad i=1,2, \ldots, N\tag{5-55}
$$
式中: $f(x, y)$ 是原始图像, $g_i(x, y)$ 是第次获取的图像, $n_i(x, y)$ 是第 $i$ 次的噪声函数。
$$
f(x, y)=\frac{1}{N} \sum_{i=1}^N g_i(x, y)-\frac{1}{N} \sum_{i=1}^N n_i(x, y)\tag{5-56}
$$
当 $N$ 很大时, 上式右边的噪声项的值趋于它的数学期望 $E\{n(x$, $y)\}$ 。一般情况下白色高斯噪声在所有 $(x, y)$ 上的数学期望等于零。 因此，原始图像为
$$
f(x, y)=\frac{1}{N} \sum_{i=1}^N g_i(x, y)\tag{5-57}
$$
盲目图像复原
若 $g_{i}(x, y)=f_{i}(x, y)^* h_{i}(x, y)$
则 $G_i(n, v)=F_i(u, v) H_{i}(u, v)$
$\ln G_{i}(n, v)=\ln \left[F_{i}(u, v)\right]+\ln \left[H_{i}(u, v)\right]$
如果帧间退化冲激响应不相关, 则
$$
\sum_{i=1}^M \ln \left[G_i(u, v)\right]=M \ln \left[F_i(u, v)\right]+\sum_{i=1}^M \ln \left[H_i(u, v)\right]
$$
当M很大时, 传递函数的对数和接近一恒定值
$$
\begin{gathered}
K_H=\lim _{M \rightarrow \infty} \sum_{i=1}^M \ln \left[H_i(u, v)\right] \quad \hat{F}_i(u, v)=\exp \left\{\frac{k_H(u, v)}{M} \prod_{i=1}^M\left[G_i(u, v)\right]^{\frac{1}{M}}\right\} \\
\hat{f}(x, y)=J^{-1}\left[\hat{F_G}(u, v)\right]
\end{gathered}
$$